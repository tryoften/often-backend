{"version":3,"sources":["app/Services/Spotify/SpotifyService.js"],"names":[],"mappings":"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","file":"app/Services/Spotify/SpotifyService.js","sourcesContent":["import 'backbone-relational';\nimport 'backbonefire';\nimport { RelationalModel, HasOne, HasMany } from 'backbone';\nimport ServiceBase from '../ServiceBase';\n\nvar spotifyWebApi = require('spotify-web-api-node');\nvar spotifyApi = new spotifyWebApi();\n\nclass SpotifyService extends ServiceBase {\n\tconstructor(){\n\t\tsuper();\n\t\tthis.provider_id = 'spotify';\n\t\tthis.fetch_interval = 4000; //in milliseconds\n\t}\n\t\n\tfetchData(queryString) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tvar response = {};\n\t\t\tthis.getSpotifyData(queryString, response).then(function(data){\n\t\t\t\tresolve(response);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetSpotifyData(searchTerm, resObj) {\n\t\treturn Promise.all([\n\t\t\tthis.searchArtists(searchTerm, resObj),\n\t\t\tthis.searchAlbums(searchTerm, resObj),\n\t\t\tthis.searchTracks(searchTerm, resObj),\n\t\t\tthis.searchPlaylists(searchTerm, resObj)\n\t\t]);\n\t\t\n\t}\n\n\tsearchPlaylists(searchTerm, resObj) {\n\t\treturn new Promise(function (resolve, reject){\n\t\t\tspotifyApi.searchPlaylists(searchTerm).then(function(data){\n\t\t\t\tvar playlistItems = data.body.playlists.items;\n\t\t\t\tvar playlists = [];\n\t\t\t\tfor(var pi in playlistItems) {\n\t\t\t\t\tplaylists.push({\n\t\t\t\t\t\tplaylist_name : playlistItems[pi].name\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tresObj.playlists = playlists;\n\t\t\t\tresolve(true);\n\t\t\t}, function(error){\n\t\t\t\tconsole.log('Error detected ' + error);\n\t\t\t\treject(false);\n\t\t\t});\n\t\t});\n\t}\n\n\tsearchTracks(searchTerm, resObj) {\n\t\treturn new Promise(function (resolve, reject){\n\t\t\tspotifyApi.searchTracks(searchTerm).then(function(data){\n\t\t\t\tvar trackItems = data.body.tracks.items;\n\t\t\t\tvar tracks = [];\n\t\t\t\tfor(var ti in trackItems) {\n\t\t\t\t\ttracks.push({\n\t\t\t\t\t\ttrack_name : trackItems[ti].name,\n\t\t\t\t\t\ttrack_image_large : trackItems[ti].album.images[0].url\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tresObj.tracks = tracks;\n\t\t\t\tresolve(true);\n\t\t\t}, function(error){\n\t\t\t\tconsole.log('Error detected ' + error);\n\t\t\t\treject(false);\n\t\t\t});\n\t\t});\n\t}\n\n\tsearchAlbums(searchTerm, resObj) {\n\t\treturn new Promise(function (resolve, reject){\n\t\t\tspotifyApi.searchAlbums(searchTerm).then(function(data){\n\t\t\t\tvar albumItems = data.body.albums.items;\n\t\t\t\tvar albums = [];\n\t\t\t\tfor(var ai in albumItems) {\n\t\t\t\t\talbums.push({\n\t\t\t\t\t\talbum_name : albumItems[ai].name,\n\t\t\t\t\t\talbum_image_large : albumItems[ai].images[0].url\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tresObj.albums = albums;\n\t\t\t\tresolve(true);\n\t\t\t}, function(error){\n\t\t\t\tconsole.log('Error detected ' + error);\n\t\t\t\treject(false);\n\t\t\t});\n\t\t});\n\t}\n\n\tsearchArtists(searchTerm, resObj) {\n\t\treturn new Promise(function (resolve, reject){\n\t\t\tspotifyApi.searchArtists(searchTerm).then(function(data){\n\t\t\t\tvar artistItems = data.body.artists.items;\n\t\t\t\tvar artists = [];\n\t\t\t\tfor(var ai in artistItems) {\n\t\t\t\t\t//console.log(artistItems[ai]);\n\t\t\t\t\t//console.log('artist ' + aristItems[ai].images[0]);\n\t\t\t\t\tartists.push({\n\t\t\t\t\t\tartist_name : artistItems[ai].name,\n\t\t\t\t\t\tartist_popularity : artistItems[ai].popularity\n\t\t\t\t\t\t//artist_image_large : aristItems[ai].images[0].url\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tresObj.artists = artists;\n\t\t\t\tresolve(true);\n\t\t\t}, function(error){\n\t\t\t\tconsole.log('Error detected ' + error);\n\t\t\t\treject(false);\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default SpotifyService;\n\n"]}